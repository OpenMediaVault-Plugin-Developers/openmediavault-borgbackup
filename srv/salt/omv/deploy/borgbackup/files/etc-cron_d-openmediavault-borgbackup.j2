{{ pillar['headers']['multiline'] }}
# This is the cron file for openmediavault-borgbackup.
# m h   dom mon dow     user    command
{%- set base = scriptsDir ~ '/' %}
{%- for archive in config.archives.archive | selectattr('enable') %}
{%- set scriptPath = base ~ scriptPrefix ~ archive.uuid %}

# {{ archive.name }}
{%- if archive.hourly > 0 and archive.hourlyenable | to_bool %}
{{ archive.hourlymin }} * * * *  root  {{ scriptPath }}
{%- endif %}
{%- if archive.daily > 0 and archive.dailyenable | to_bool %}
{{ archive.dailymin }} {{ archive.dailyhour }} * * *  root  {{ scriptPath }}
{%- endif %}
{%- if archive.weekly > 0 and archive.weeklyenable | to_bool %}
{{ archive.weeklymin }} {{ archive.weeklyhour }} * * 1  root  {{ scriptPath }}
{%- endif %}
{%- if archive.monthly > 0 and archive.monthlyenable | to_bool %}
{{ archive.monthlymin }} {{ archive.monthlyhour }} 1 * *  root  {{ scriptPath }}
{%- endif %}
{%- if archive.yearly > 0 and archive.yearlyenable | to_bool %}
{{ archive.yearlymin }} {{ archive.yearlyhour }} 1 1 *  root  {{ scriptPath }}
{%- endif %}
{%- endfor %}
